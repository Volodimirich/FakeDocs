# Обучение модели T5-FRED и результаты экспериментов

Модель: [ai-forever/FRED-T5-1.7B](https://huggingface.co/ai-forever/FRED-T5-1.7B) от Сбера

Конфиг обучения:
```commandline
# Model
model:
  model_name: "ai-forever/FRED-T5-1.7B
  tokenizer_name: "ai-forever/FRED-T5-1.7B"
  local_path: './result_T5-FRED-1.7B_new_data_train'
  input_max_length: 20
  target_max_length: 750

# TrainingArguments
train_params:
  num_train_epochs: 15  # number of training epochs
  per_device_train_batch_size: 4  # batch size for training
  per_device_eval_batch_size: 4  # batch size for evaluation

  # Optimizer
  lr: 1e-3
  optim: 'adafactor',

```

# Обучение на данных, отобранных с сайта "[Как Просто](prepare_data.md). DS 1"
## Примеры

Запрос:
```
антенна для цт вязьма
```
Сгенерированный документ:
```
Инструкция 1 Антенна для телевизора имеет большее распространение, чем антенный кабель. Во-первых, ее легче спрятать в
стену. Во-вторых, она гораздо меньше по размеру. И в-третьих, ее можно подключить к телевизору, ноутбуку, компьютеру или
планшету. 2 Существует несколько видов антенн для телевизора. Они различаются по своей конструкции. Наиболее простая
антенна представляет собой отрезок металлического кабеля с заземлением. Такую антенну легко установить на любой тип
телевизора. Она практически не требует обслуживания. Ее легко монтировать и демонтировать. Но она имеет существенный
недостаток - возможность приема лишь очень узкого диапазона волн. Это касается как телевизоров с диагональю экрана до 36"
так и 55". 3 Наиболее распространенной антенной для телевизора является дуплексная антенна. Она представляет собой два
провода, которые скручиваются между собой и запаиваются. Такую антенну очень просто монтировать и демонтировать. Ее легко
подключить к телевизору, ноутбуку, компьютеру или планшету. Ее можно использовать и в качестве внешней антенны. 4 Кроме
дуплексной антенны, существуют и другие виды антенн для телевизора. Например, есть параболическая антенна. Ее особенностью
является наличие на конце двух зеркал. Такую антенну очень просто установить и демонтировать. 5 Для подключения к
телевизору антенны, которая имеет в своем составе несколько зеркал, необходимо собрать конструкцию, состоящую из
нескольких элементов. Зеркала крепятся между собой при помощи болтов, которые необходимо отвернуть. На их место затем
устанавливаются отражатели. Вся конструкция собирается и подключается к телевизору. 6 Существует еще одна разновидность
антенн - коаксиальная. Ее особенностью является наличие на конце трубы двух металлических наконечников. Такая антенна тоже
может устанавливаться на телевизор. 7 В продаже можно найти универсальные антенны, которые подходят ко всем видам
телевизоров. Их можно монтировать на стену, на потолок, а также на опоры. Они имеют достаточно простую конструкцию. 8
Также антенны могут разделяться на активные и пассивные. Пассивная антенна имеет в своем составе только один активный
элемент. Ее легко монтировать и демонтировать. При этом ее можно использовать и в качестве внешней антенны. 9 Пассивная
антенна подключается к телевизору при помощи специального кабеля. Его длина должна превышать длину кабеля антенны для
телевизора минимум в два раза. Видео по теме
```

Запрос:
```
аромомасла снижение аппетита
```
Сгенерированный документ:
```
При употреблении арахисового масла значительно снижается аппетит. Вещества, входящие в его состав, нормализуют работу
пищеварительной системы и способствуют снижению веса. В частности, в состав масла входит большое количество липоевой
кислоты, которая снижает уровень холестерина в крови и препятствует всасыванию жиров в кишечнике. Также благодаря
содержанию в масле линолевой кислоты снижается риск возникновения сердечно-сосудистых заболеваний. Вкупе с другими
растительными маслами арахисовое эффективно при лечении и профилактике ожирения. Особенностью масла является наличие в его
составе большого количества витамина Е, который способствует профилактике сердечно-сосудистых заболеваний и старения.
Витамин Е также способствует снижению аппетита и оказывает антиоксидантное действие. Арахисовое масло снижает аппетит не
только благодаря своему составу. Дело в том, что в нем содержится большое количество витамина F, который способствует
снижению уровня глюкозы в крови. Помимо этого растительный жир, входящий в состав масла, является отличным антиоксидантом,
который препятствует всасыванию жиров в кишечнике. Витамин F в свою очередь снижает риск возникновения сердечно-сосудистых
заболеваний. Вкупе с другими растительными маслами арахисовое эффективно при лечении и профилактике остеопороза,
атеросклероза и тромбоза. Помимо этого растительный жир, входящий в состав масла, способствует улучшению работы иммунной
системы. Арахисовое масло богато витамином F, который благотворно влияет на состояние волос и ногтей, а также является
антиоксидантом, который препятствует всасыванию жиров в кишечнике. Видео по теме
```

Запрос:
```
архивная выписка из домой книги через госуслуги
```
Сгенерированный документ:
```
Инструкция 1 Прежде чем оформлять документы для выписки из домовой книги через интернет, вам нужно узнать точный адрес,
по которому зарегистрирован данный объект недвижимости. Для этого зайдите на сайт «Госуслуги», выберите свою региональную
прописку и найдите свой кадастровый номер. 2 После заполнения всех необходимых данных выберите «Документы для выписки из
домовой книги» в новом окне и нажмите «Далее». Выберите вашу квартиру из предложенного списка и перейдите к заполнению
реквизитов для выписки. Укажите фамилию, имя, отчество, дату рождения, пол, ИНН, телефон и адрес электронной почты. 3
Нажмите «Далее». Укажите размер оплаты госпошлины за оказание государственной услуги по выдаче выписки из домовой книги.
Размер пошлины зависит от вида документа, вида собственности на квартиру и региона, в котором вы зарегистрированы.
Квитанцию об оплате можно распечатать с сайта «Госуслуги» или получить в отделении банка. 4 После выбора всех необходимых
реквизитов для выписки нажмите «Далее». На вашем экране появится выписка из домовой книги. Обратите внимание на номер
квартиры, указанный на ней, ведь именно на него вам нужно будет записать данные из выписки. Полезный совет Если вы хотите
заказать срочную выписку из домовой книги, то вам необходимо внести первоначальный взнос за оказание услуги. Размер оплаты
зависит от вида выписки, его можно узнать на сайте «Госуслуги» или в отделении банка.
```

Можно заметить, что текста хорошие, но замечается написание текстов в стиле инструкций, что показательно для DS 1

## Результаты на модели ранжирования
Для оценки текстов использовалась также предоставленная модель ранжирования, в которую подается набор текстов и для каждого текста выдается соответствующая оценка. Оценка ранжировщика для данной модели:
* Медианная позиция: 17 
* Средневзвешенная позиция: 16.69
* Медианная позиция в процентах: 47.06%

Описание метрик:
* Медианная позиция - медианная позиция сгенерированных текстов для всех запросов. Чем меньше - тем лучше.
* Средневзвешенная позиция - средняя позиция сгенерированных текстов для всех запросов, взвешенная на обратное кол-во документов для данного запроса - чем меньше документов, тем менее значимый результат. Чем меньше - тем лучше.
* Медианная позиция в процентах - медианный процент текстов, который лучше сгенерированного. Чем меньше - тем лучше.

## Итог
Данная модель хорошо генерирует ответы в стиле инструкций, а также генерирует чистый текст, как бы его писал человек. Ранжировщик оценивает эту модель средне, т.к. модель не так часто повторяет части запроса в сгенерированном тексте.

# Обучение на данных, отобранных с помощью "[label 3 + Оценки перплексии](prepare_data.md). DS 2"
## Примеры

Запрос:
```
антенна для цт вязьма
```
Сгенерированный документ:
```
Антенна для ЦТ "Вязьма" с 1 июня 2015 года Цены на услугу Антенна для ЦТ "Вязьма" с 1 июня 2015 года Подробнее о
предоставлении услуги Антенна для ЦТ «Вязьма» Вызов специалиста по установке и настройке оборудования 1 600 руб. 1 000
руб. Доставка 1 600 руб. Подробнее о предоставлении услуги Видеонаблюдение Установка и настройка системы IP-камер Монтаж и
запуск системы «Умный дом» Услуги связи: - Антенна для ЦТ "Вязьма" - от 1 600 руб. (в зависимости от сложности и объема
работ) - Установка в г. Вязьме, районе: Северный - от 3 600 руб. (в зависимости от сложности и объема работ) -
Проектирование, монтаж, запуск, обучение персонала заказчика - от 3 000 руб. (в зависимости от объема работ) Гарантия на
оказанные услуги 1 год. Подробнее о сервисе 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29
30 31 Вызов мастера: Бесплатно! Запись на услугу Антенна для ЦТ "Вязьма" доступна в любое время без выходных по телефону:
+7 (4812) 59-58-98. Услуга оказывается компанией «Стек». 
```

Запрос:
```
аромомасла снижение аппетита
```
Сгенерированный документ:
```
Жирное мясо вредно для здоровья человека » Ароматические масла — снижение аппетита Ароматические масла — снижение аппетита
Витамины для похудения Фитонутриенты Омега-3 Омега-6 » Ароматические масла — снижение аппетита Выпитый стакан тёплого
молока с ложечкой мёда или сдобной булочки поможет восстановить утраченные вкусовые рецепторы. Но молоко с мёдом или
сдобной булочкой — не единственные продукты, способствующие увеличению аппетита. Эффективно снизить тягу к вредной пище
помогают эфирные масла. Существует мнение, что ароматические масла способны снижать аппетит, что даже влияет на изменение
пищевого поведения человека. Какие масла снижают аппетит? Можно ли с их помощью контролировать аппетит? И как выбрать
подходящее масло для своего организма? Масло жожоба оказывает на организм общеукрепляющее действие, улучшает обмен
веществ, повышает тонус кожи, укрепляет волосы и ногти. Полезно масло при диабете и сердечно-сосудистых заболеваниях,
атеросклерозе. Кроме того, его применяют для улучшения кровообращения, как противовоспалительное и антисептическое
средство. Масло чайного дерева нормализует артериальное давление. Если вдыхать пары этого масла регулярно, можно
нормализовать сон и избавиться от бессонницы. Масло гвоздики насыщает воздух приятным ароматом, благоприятно воздействует
на нервную систему, повышает настроение. Если вдыхать масло этого растения несколько раз в день, нормализуется сон. Масло
герани уменьшает стресс, обладает успокаивающим действием, снимает нервное напряжение. Масло чайного дерева расширяет
сосуды, что замедляет кровоток, способствует устранению головной боли, снижает повышенное артериальное давление. Масло
абрикоса обладает прекрасным тонизирующим эффектом. Чайное дерево обладает противовоспалительными свойствами, расширяет
сосуды, повышает тонус кожи. При регулярном употреблении этого масла нормализуется вес, исчезают головные боли, уходит
бессонница. Масло примулы вечерней уменьшает стресс, повышает настроение, благотворно влияет на работу мозга. Природные
антидепрессанты — масло чайного дерева и масло грецкого ореха — нормализуют сон, уменьшают проявления депрессии. Масло
орегано уменьшает неприятные симптомы при простуде, предотвращает появление головной боли и заложенности носа. Масло семян
льна уменьшает тошноту и рвоту, способствует устранению неприятного запаха изо рта, предотвращает появление трещин на
губах. Масло чайного дерева повышает умственную активность, лечит апатию и депрессию. Масло кипариса обладает
антисептическим, противовоспалительным действием, ускоряет заживление трещин на пятках, способствует выведению токсинов из
организма. Масло майорана уменьшает нервозность, тревогу, способствует снятию воспаления в горле. Масло гвоздики обладает
антисептическим, противовоспалительным, обезболивающим действием, снимает зуд. Масло чайного дерева улучшает общее
состояние кожи, замедляет процессы старения. Масло лимона обладает тонизирующим эффектом, повышает тонус, способствует
заживлению трещин и ссадин. Масло грецкого ореха обладает противосудорожным действием, хорошо влияет на работу нервной
системы. Витамины для похудения Энергетическая ценность 100 г масла: белки — 11.4 г, жиры — 3.8 г, углеводы — 5.2 г.
Энергетическая ценность 100 г масла: белки — 7.2 г, жиры — 3.8 г, углеводы — 5.2 г. Энергетическая ценность 100 г масла:
белки — 7.2 г, жиры — 6.8 г, углеводы — 19.4 г. Калорийность: 336 кКал Энергетическ
```

Запрос:
```
архивная выписка из домой книги через госуслуги
```
Сгенерированный документ:
```
Главная / Справка из дома книги через Госуслуги Справка из дома книги через Госуслуги Выписка из домовой книги,
оформленная через портал Госуслуги, является официальным документом, который подтверждает факт проживания гражданина в
жилом помещении на конкретной площади. Предоставление такой выписки является одной из услуг, которую оказывает портал
Госуслуги. Как получить справку о проживании на портале Госуслуги? Для того чтобы получить на портале Госуслуги справку о
проживании, необходимо выполнить ряд шагов: Перейти на портал Госуслуги. Войти в Личный кабинет. Ввести свой номер
телефона и адрес электронной почты. Выбрать раздел «Электронные услуги». Кликнуть по ссылке «Получение справки из дома
книги». Выбрать подраздел «Электронные услуги». Предложить свою кандидатуру на должность ответственного за получение
выписки из дома книги. После того как заявка будет рассмотрена, пользователю придёт уведомление на электронную почту или в
личный кабинет. В течение 5 рабочих дней специалист свяжется с заявителем и попросит привезти оригиналы документов,
подтверждающих личность, либо их копии. Справка из дома книги может быть предоставлена в бумажном виде и в электронном
виде. Обратите внимание, что в первом случае она имеет ограниченный срок действия, в течение которого действует ссылка на
страницу с информацией о документе. Электронная выписка из дома книги будет действовать в течение 30 дней со дня ее
создания. Справка о проживании на портале Госуслуги может быть предоставлена в виде: Информационного сообщения – в этом
случае пользователю будет отправлено уведомление о том, что на сайте была получена справка из дома книги, на электронный
адрес или в личный кабинет; Регистрационной карты – выдается тем, кто впервые обращается на портал Госуслуги; Выписки –
оформляется на бумажном носителе и высылается на электронный адрес. Получение выписки на портале Госуслуги значительно
экономит время пользователей. Вам не придется посещать библиотеку или архив для получения архивной справки, поскольку вся
работа будет проделана за вас. Вам необходимо лишь один раз прийти в офис многофункционального центра или к пункту выдачи
документов. Следует отметить, что срок действия архивной справки, выданной на сайте Госуслуги, не ограничен. Где взять
справку о проживании через портал Госуслуги? Как получить справку о месте пребывания? Где заказать справку о доходах через
Госуслуги? Как получить справку о составе семьи через Госуслуги? Выписка из домовой книги на портале Госуслуги. ©
2017-2022 МФЦ г. Сургута 
```

Можно заметить, что текста хорошие, но замечается наличие разметки с сайтов, что показательно для DS 2

## Результаты на модели ранжирования
* Медианная позиция: 6 
* Средневзвешенная позиция: 10.77
* Медианная позиция в процентах: 47.29%

## Итог
Данная модель хорошо генерирует разнообразные ответы, но модель добавляет разметку в свой текст, что не свойственно человеку. Ранжировщик оценивает эту модель хорошо, т.к. модель часто повторяет части запроса в начале генерации, что соответствует разметке сайта.
